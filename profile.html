<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>H·ªì s∆° ng∆∞·ªùi d√πng - HyperBuy</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <style>
    body {
      background-color: #f9fafb;
      font-family: 'Inter', sans-serif;
    }

    main.container {
      margin-top: 60px;
      max-width: 900px;
    }

    #user-profile {
      background: #fff;
      border-radius: 16px;
      padding: 30px 40px;
      box-shadow: 0 5px 18px rgba(0,0,0,0.05);
      margin-bottom: 40px;
    }

    #user-profile h2 {
      font-size: 1.5rem;
      font-weight: 600;
      color: #1e293b;
      border-bottom: 2px solid #3b82f6;
      padding-bottom: 10px;
      margin-bottom: 25px;
    }

    #profile-info p {
      font-size: 1rem;
      margin: 10px 0;
      color: #374151;
    }

    #profile-info strong {
      color: #1e293b;
      width: 160px;
      display: inline-block;
    }

    .btn {
      border: none;
      border-radius: 8px;
      padding: 10px 18px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }

    .btn-primary {
      background: linear-gradient(135deg, #6366f1, #3b82f6);
      color: white;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #4f46e5, #2563eb);
      transform: translateY(-2px);
    }

    .btn-info {
      background: #e0f2fe;
      color: #0369a1;
    }

    .btn-info:hover {
      background: #bae6fd;
    }

    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
    }

    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 25px 30px;
      border-radius: 12px;
      max-width: 600px;
      position: relative;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }

    .close-button {
      position: absolute;
      top: 12px;
      right: 18px;
      font-size: 22px;
      cursor: pointer;
      color: #555;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-control {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #d1d5db;
      font-size: 0.95rem;
    }

    footer {
      background: #f1f5f9;
      padding: 20px;
      text-align: center;
      color: #6b7280;
      border-top: 1px solid #e5e7eb;
    }
    #profile-actions-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 15px;
    }

    #profile-actions-buttons .btn {
      min-width: 180px;
      text-align: center;
    }

    /* Nh√≥m n√∫t action c·ª≠a h√†ng */
    #profile-store-actions {
      margin-top: 18px;
      display: none;           /* m·∫∑c ƒë·ªãnh ·∫©n, JS show cho SELLER */
    }
    /* Nh√≥m n√∫t action c·ª≠a h√†ng */
      #profile-store-actions .btn {
        margin-right: 8px;
        margin-bottom: 8px;
        min-width: 180px;
        text-align: center;
      }
          .profile-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .logout-icon-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 24px;
      color: #ef4444;
    }
    .logout-icon-btn:hover {
      color: #dc2626;
      transform: scale(1.1);
      transition: 0.15s;
    }
  </style>
</head>

<body>
  <header>
    <nav id="main-navbar">
      <div class="container nav-container">
        <a href="index.html" class="nav-brand">‚ö° HyperBuy</a>
        <ul id="main-nav" class="nav-links">
          <li><a href="index.html" id="nav-home" class="nav-link">Trang Ch·ªß</a></li>
          <li><a href="products.html" id="nav-products" class="nav-link">S·∫£n Ph·∫©m</a></li>
          <li id="nav-profile"><a href="profile.html" class="nav-link active">H·ªì S∆°</a></li>
          <li id="nav-my-orders"><a href="my-orders.html" class="nav-link">ƒê∆°n H√†ng</a></li>
          <li><a href="minigame.html" class="nav-link">MiniGame</a></li>
          <li id="nav-cart-link-li"><a href="cart.html" class="nav-link">Gi·ªè H√†ng</a></li>
                          <!-- üîî TH√îNG B√ÅO -->
                <li id="nav-notification-bell" style="display:none; position:relative;">
                    <a href="#" class="nav-link nav-link-bell">
                        <i class="fas fa-bell"></i>
                        <span id="notification-count" class="notification-badge" style="display:none;"></span>
                    </a>

                    <div id="notification-dropdown" class="notification-list-dropdown">
                        <div class="notification-dropdown-header">Th√¥ng b√°o</div>
                        <ul id="notification-list-items" class="notification-list">
                            <li><a class="dropdown-item-notif">Kh√¥ng c√≥ th√¥ng b√°o n√†o.</a></li>
                        </ul>
                        <div class="notification-dropdown-footer">
                            <a href="notifications.html">Xem t·∫•t c·∫£ th√¥ng b√°o</a>
                        </div>
                    </div>
                </li>
        </ul>
      </div>
    </nav>
  </header>
<main class="container">
  <section id="user-profile">

    <div id="profile-header" class="profile-header">
      <h2>
        <i class="fas fa-user-circle"></i> Th√¥ng tin c√° nh√¢n
      </h2>

      <!-- üî¥ ICON ƒêƒÇNG XU·∫§T -->
      <button id="btn-logout-profile"
              type="button"
              class="logout-icon-btn"
              title="ƒêƒÉng xu·∫•t">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    </div>


      <div id="profile-loading" style="display:none;">
        <p>ƒêang t·∫£i th√¥ng tin h·ªì s∆°...</p>
      </div>

      <div id="profile-info" style="display:none;">
        <p><strong>T√™n ƒëƒÉng nh·∫≠p:</strong> <span id="profile-username">N/A</span></p>
        <p><strong>H·ªç v√† t√™n:</strong> <span id="profile-name">N/A</span></p>
        <p><strong>Email:</strong> <span id="profile-email">N/A</span></p>
        <p><strong>Ng√†y sinh:</strong> <span id="profile-dob">N/A</span></p>
        <p><strong>Vai tr√≤:</strong> <span id="profile-role">N/A</span></p>
      </div>

      <div id="profile-error" class="error-message" style="display:none;"></div>

    <div id="profile-actions" style="margin-top: 25px;">

      <!-- H√†ng n√∫t chung cho m·ªçi user -->
      <div id="profile-actions-buttons">
        <button id="openSellerRequestModalBtn"
                class="btn btn-primary"
                style="display:none;">
          ƒêƒÉng k√Ω B√°n h√†ng
        </button>

        <a href="my-ratings.html"
          id="btn-view-my-ratings"
          class="btn btn-secondary"
          style="background:#f97316; color:#fff;">
          ‚≠ê Xem ƒë√°nh gi√° c·ªßa t√¥i
        </a>
      </div>

      <!-- Status ƒëƒÉng k√Ω seller (n·∫øu c√≥) -->
      <p id="seller-status-message"
        style="margin-top: 10px; font-weight: 500;"></p>
    </div>

    <!-- KHU V·ª∞C ACTION C·ª¨A H√ÄNG CHO SELLER -->
    <div id="profile-store-actions">
      <button id="btn-view-my-store" class="btn btn-info">
        Xem C·ª≠a h√†ng C·ªßa T√¥i
      </button>

      <button id="btn-add-product-my-store" class="btn btn-primary">
        Th√™m s·∫£n ph·∫©m m·ªõi
      </button>

      <a href="seller-orders.html"
        id="btn-seller-manage-orders"
        class="btn btn-primary"
        style="background:#10b981;">
        <i class="fas fa-box"></i> Qu·∫£n l√Ω ƒë∆°n h√†ng c·ª≠a h√†ng
      </a>

      <a href="seller-revenue.html"
        id="btn-seller-revenue"
        class="btn btn-primary"
        style="background:#3b82f6;">
        <i class="fas fa-chart-line"></i> Xem Doanh Thu
      </a>

      <div id="my-store-info-container"
          style="margin-top: 15px; display:none; background-color: #f9fafb; padding:15px; border-radius: 10px;">
        <h4>Th√¥ng tin C·ª≠a h√†ng</h4>
        <p><strong>T√™n c·ª≠a h√†ng:</strong> <span id="my-store-name">N/A</span></p>
        <p><strong>ID c·ª≠a h√†ng:</strong> <span id="my-store-id">N/A</span></p>
        <p><strong>Gi·∫•y ph√©p KD:</strong> <span id="my-store-license">N/A</span></p>
        <div id="my-store-products-profile" class="modal-products-grid" style="margin-top:10px;"></div>
      </div>
    </div>

    </section>
  </main>

  <!-- Modal: ƒêƒÉng k√Ω tr·ªü th√†nh ng∆∞·ªùi b√°n -->
  <div id="sellerRequestModal" class="modal">
    <div class="modal-content">
      <span id="closeSellerRequestModalBtn" class="close-button">&times;</span>
      <h2>ƒêƒÉng K√Ω Tr·ªü Th√†nh Ng∆∞·ªùi B√°n</h2>
      <form id="sellerRequestForm">
        <div class="form-group">
          <label for="storeNameModalProfile">T√™n c·ª≠a h√†ng mong mu·ªën:</label>
          <input type="text" id="storeNameModalProfile" name="storeName" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="businessLicenseModalProfile">M√£ s·ªë GPKD (n·∫øu c√≥):</label>
          <input type="text" id="businessLicenseModalProfile" name="businessLicense" class="form-control">
        </div>
        <div class="form-group" style="margin-top: 15px;">
          <button type="submit" class="btn btn-primary">G·ª≠i Y√™u C·∫ßu</button>
        </div>
        <p id="seller-request-message" style="display:none; margin-top:10px;"></p>
      </form>
    </div>
  </div>

  <!-- Modal: Th√¥ng tin c·ª≠a h√†ng -->
  <div id="sellerInfoModal" class="modal">
    <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
      <span class="close-button" title="ƒê√≥ng">&times;</span>
      <h2>Th√¥ng Tin C·ª≠a H√†ng</h2>
      <div id="seller-details-content">
        <p><strong>T√™n c·ª≠a h√†ng:</strong> <span id="modal-seller-store-name">N/A</span></p>
        <p><strong>Ch·ªß c·ª≠a h√†ng:</strong> <span id="modal-seller-owner-name">N/A</span></p>
        <p><strong>Username:</strong> <span id="modal-seller-username">N/A</span></p>
        <p><strong>Email li√™n h·ªá:</strong> <span id="modal-seller-email">N/A</span></p>
        <p><strong>GPKD:</strong> <span id="modal-seller-license">N/A</span></p>
      </div>
      <hr>
      <h4>S·∫£n ph·∫©m c·ªßa C·ª≠a h√†ng</h4>
      <div id="modal-seller-products" class="modal-products-grid">
        <p>ƒêang t·∫£i s·∫£n ph·∫©m c·ªßa c·ª≠a h√†ng...</p>
      </div>
    </div>
  </div>

  <footer>
    <p>&copy; <span id="current-year"></span> HyperBuy. M·ªçi quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
  </footer>

<script src="js/main.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    if (!isLoggedIn()) {
      alert("B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p!");
      location.href = "login.html";
      return;
    }

    const username = localStorage.getItem("username") || "";
    const role = getUserRole();
    const email = localStorage.getItem("email") || "";

    document.getElementById("profile-username").textContent = username;
    document.getElementById("profile-email").textContent = email;
    document.getElementById("profile-role").textContent = role;

    // Cho SELLER hi·ªÉn th·ªã khu c·ª≠a h√†ng
    if (role === "SELLER") {
      const storeActions = document.getElementById("profile-store-actions");
      if (storeActions) storeActions.style.display = "block";
    }

    document.getElementById("current-year").textContent =
      new Date().getFullYear();

    // N√∫t ƒêƒÉng xu·∫•t tr√™n navbar
    const navLogout = document.getElementById("nav-logout");
    if (navLogout) {
      navLogout.onclick = () => {
        handleLogout();
      };
    }

    // üî¥ N√∫t ƒêƒÉng xu·∫•t trong profile (icon ƒë·ªè, s√°t ph·∫£i)
    const btnLogoutProfile = document.getElementById("btn-logout-profile");
    if (btnLogoutProfile) {
      btnLogoutProfile.addEventListener("click", (e) => {
        e.preventDefault();
        console.log("Logout from profile clicked");
        handleLogout();
      });
    }
  });
</script>